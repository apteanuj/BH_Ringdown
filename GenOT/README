Quickstart instruction for generating world lines with the C++ code

These instructions work best in a unix-type system.

1. Make sure key files are present.  You should have code:
  * Globals.h,
  * Tensors.h,
  * TP.h,
  * ParamWLMino.cc,
  * WL_BL.cc
These files code up all the key steps in Apte and Hughes 2019.

One data file:
  * OT_X_vs_L.dat
This contains the "universal" transition function X(L), Fig 2 of AH2019.

A directory of additional important data files:
  * AdData: contains "_insp" directories, which in turn give contain
  directories like "a0.1_insp", each of which holds a number of
  adiabatic inspiral files.  These files are made using the main
  GREMLIN code; more on them below.

2. Compile the two .cc files:

g++ ParamWLMino.cc -o ParamWLMino -lm
g++ WL_BL.cc -o WL_BL -lm

The first of these codes converts the "Adiabatic" data files to
produce Mino-time parameter space worldline.  The second one converts
from Mino-time to a Boyer-Lindquist worldline that feeds directly into
the time-domain integrator.  The codes are both set up so that if you
run them without arguments, it tells you what arguments must be
provided in order to run them properly:

3. Convert an adiabatic worldline into a Mino-time inspiral /
transition / plunge trajectory.

hmunu.[20:21].Code.16.% ./ParamWLMino
Arguments: 1. a  2. eta  3. adiabatic inspiral data filename
           4. LTi, the Ori-Thorne time at which transition begins
           5. LTf, the Ori-Thorne time at which transition ends
	   6. Value of r to start the inspiral
           7. Model for evolution of integrals in transition:
                1 == constant plus quadratic to enforce continuity
                2 == quadratic plus cubic to enforce continuity

hmunu.[20:22].Code.17.% ./ParamWLMino 0.5 1e-4 a0.5_insp_060 -5 2.5 15 2 > a0.5_eta1e-4_LTi-5_LTf2.5.mino

The inputfile a0.5_insp_060 was generated by GREMLIN, and presents the
"inspiral-only" model for the worldline.  It was made by reading in
the raw (binary format) Teukolsky data and then generating the
sequence of orbits through which in the adiabatic approximation the
orbit passes as it approaches the last stable orbit.  See Notes 1 and
3 below for further potentially important information.

Key physics parameters we provide here are the black hole spin (in
principle, this should be encoded in the "_insp" file; in practice,
I've just left it as a runtime parameter; it is very important that
these be kept consistent), the mass ratio eta (see Note 1), the values
of the Mino-time-like parameter L at which inspiral ends and
transition begins (LTi) and at which transition ends and plunge begins
(LTf) (see Note 2 for comments on these parameters); the radius at which
the inspiral begins (any value of r in the domain of the adiabatic data
file); and the choice of model for how to evolve the "constants" during
the transition (see Note 4 for discussion).

The file a0.5_eta1e-4_LTi-5_LTf2.5.mino will now contain all data
describing the Mino-tim trajectory.  (If you don't do the redirect
with the file name, the output will just print to the screen.)  File
format:

Column 1: Mino time lambda
Column 2: Orbital radius r
Column 3: Value of theta_inc (which changes slightly during inspiral)
Column 4: Energy E
Column 5: Axial angular momentum L
Column 6: Carter constant Q

4. Convert the Mino-time trajectory into a Boyer-Lindquist time
worldline:

hmunu.[20:30].Code.20.% ./WL_BL
Args: 1. a  2. Mino time trajectory filename
      3. Mino time in trajectory to start WL
      4. BL time at which to stop WL
      5. Initial value of angular phase chi (degrees)
      6. Initial value of axial angle phi (degrees)

Parameter 3 is introduced because the Mino-time trajectory typically
covers a wider stretch of data than we need.  You should look at the
Mino-time trajectory file and make a trajectory that covers enough
ground to have a decent inspiral, but not have a result that is so
long that it would take a month to run.  Parameter 4 basically
controls how long the small body sits on the horizon at the end of
plunge as seen in BL time.  I generally experiment with parameters 3
and 4 to get a decent result.

Parameter 5 sets the initial phase, controlling where in the theta
oscillation cycle the orbit is at time t = 0.  Reminder, the phase chi
fixes theta via

cos(theta) = cos(theta_m) cos(chi + chi_0)
           = sin(theta_inc) cos(chi + chi_0)

We use this parameter to get different values of theta_f as the small
body completes its plunge.

Parameter 6 just controls the initial axial position; it can safely be
set to zero.

Example of use:

hmunu.[20:37].Code.3.% ./WL_BL 0.5 a0.5_eta1e-4_LTi-5_LTf2.5.mino -100 6500 0 0

This will put output into a filename that encodes the black hole spin,
the value of theta_inc (see Note 5), the value of theta_f (see Note
6), and whether the angle theta is increasing ("p" for positive) or
decreasing ("n" for negative) at the end of the trajectory.  The file
will have the suffix ".traj."  The format of this .traj file is such
that it can be used as input for the time-domain Teukolsky solver: Its
output data is in the form

time  r  th  dr/dt  dth/dt  dph/dt  ph  E  Lz  Q

---------------

Many of the internal parameters and conventions follow those used in
Apte and Hughes 2019 (https://arxiv.org/abs/1901.05901, hereafter
AH2019).  A few particularly important things to note:

Note 1: The adiabatic inspiral assumes that the small body's worldline
is accurately described by a sequence of geodesic orbits at all times.
If this were correct, then the worldline's behavior would be
"universal" in the sense that we could scale every important quantity
by factors of total mass and mass ratio.  As such, the "_insp" file
contains the trajectory the small body would follow IF this were
correct, with all factors of mass and mass ratio scaled out.  We put
mass ratio back in to make scalings we need for our analysis, and to
compute the behavior of the transition regime.  This is discussed at
length in AH2019.  (The final result follows the usual relativity
conventions, and scales all quantities to the total mass as usual.)

Note 2: In AH2019, we discuss at length the values of the parameter L
that work well to describe the transition from inspiral and to plunge.
Punchline: we argue that LTI = -3 and LTf = 2.35 work well.  That
being said, Gaurav Khanna is now doing some work exploring how well
these inspiral / transition / plunge waveforms can be made to match
with numerical relativity, and is finding that smaller values of LTf
may work better at making that match.  Hold that thought for now, but
we may want to be prepared to adjust this.

Note 3: In this package, we provide all the _insp files that were used
to produce the data that was used to write AH2019, Lim, Khanna, Apte,
and Hughes PRD 2019, and Hughes, Apte, Khanna, and Lim PRL 2019.  If
you would like other cases, it will take some processing to develop
it, so please let Hughes know!

Note 4: The two models are discussed in AH2019 Sec IVA2.  The
"constant plus cubic" model was originally used by Sundararajan, but
for reasons we discuss in the paper the "cubic plus quartic" model is
closer to the spirit of the original Ori & Thorne formulation.  For
mass ratios more extreme than eta = 0.01, the different between these
models is negligible.

Note 5: The parameter theta_inc describes the inclination of the orbit
to the black hole's equatorial plan: theta = 0 is prograde equatorial,
180 is retrograde equatorial.  As this work was being developed, the
Black Hole Perturbation Toolkit community settled on the name $I$ for
this angle.  The code and data has not yet been rationalized with this
new name choice.

Note 6: The parameter theta_f describes the value of the angle theta
at which the plunging body crosses the event horizon.  For a given
value of I (or theta_inc), we can have 90 - I <= theta_f <= 90 + I
(for I <= 90), or I - 90 <= theta_f <= 180 - I (for I >= 90).  The
actual value we get depends on the small body's orbital phase as it
enters plunge, and was explored at some length in Lim et al 2019.




